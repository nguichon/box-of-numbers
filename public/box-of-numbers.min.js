/*! box-of-numbers 2014-12-08 */
function BoxOfNumbersGame(a){function b(a,b){this.value=b,this.title=a,$("#score-board").append('<li class="score-item"><strong>'+a+': </strong><span id="score'+a+'">'+this.value+"</span></li>")}function c(a,b){function c(){if(!j&&!h){if(d)return k.unflip();if(d=!0,$("#"+a).addClass("flipped"),$("#"+a+">.back").html(b),g.modify(1),e.modify(CLICK_SCORE),!i||i===k)return i=k;j=!0,setTimeout(function(){j=!1,f.modify(1),i.doesNumberMatch(b)?(e.modify(GOOD_MATCH_SCORE),k.matchFound(),i.matchFound()):(e.modify(BAD_MATCH_SCORE),k.unflip(),i.unflip())},MATCH_ATTEMPT_PAUSE_DURATION_MS)}}var d=!1,h=!1,k=this;this.attach=function(){$("#game-board").append('<div class="container"><div class="card" id='+a+'><figure class="front"></figure><figure class="back"></figure></div></div>'),$("#"+a).click(c)},this.unflip=function(){j||(i===k&&(i=null),d=!1,$("#"+a).removeClass("flipped"),setTimeout(function(){d||$("#"+a+">.back").html("")},HIDE_CARD_FACE_VALUE_DELAY_MS))},this.matchFound=function(){h=!0,$("#"+a).addClass("matched"),k.unflip()},this.doesNumberMatch=function(a){return b===a}}var d=a+DIFFICULTY_SQUARE_MODIFIER,e=new b("Score",SCORE_PER_DIFFICULTY*d),f=new b("Attempts",0),g=new b("Flips",0),h=new b("Difficulty",a),i=null,j=!1,k=!1;b.prototype.set=function(a){this.value=a,$("#score"+this.title).html(this.value)},b.prototype.modify=function(a){this.value+=a,$("#score"+this.title).html(this.value)},this.start=function(){if(!k){k=!0;for(var a=Math.pow(d,2),b=[],e=0;a-a%2>e;e++)b.push(new c(e,Math.floor(e/2)));shuffle(b),$("#game-board").css("width",120*d);for(var f=0,g=a%2,e=0;a>e;e++)g&&e===Math.floor(a/2)?$("#game-board").append('<div class="container"><div class="card matched"><figure class="front"></figure><figure class="back">X</figure></div></div>'):b[f++].attach()}},this.changeDifficulty=function(){k||(this.trueDifficulty=a+DIFFICULTY_SQUARE_MODIFIER,e.set(d*SCORE_PER_DIFFICULTY),h.set(a))}}function shuffle(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a}function startGame(){var a=new BoxOfNumbersGame(2);a.start()}var CLICK_SCORE=-1,GOOD_MATCH_SCORE=2,BAD_MATCH_SCORE=-1,MATCH_ATTEMPT_PAUSE_DURATION_MS=800,HIDE_CARD_FACE_VALUE_DELAY_MS=300,SCORE_PER_DIFFICULTY=50,DIFFICULTY_SQUARE_MODIFIER=2;$(document).ready(startGame);